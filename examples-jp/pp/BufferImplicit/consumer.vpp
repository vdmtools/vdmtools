\documentclass[dvips,landscape,a4paper]{jarticle}

\usepackage{vpp}
\usepackage{longtable}
\usepackage[dvips]{color}
\definecolor{covered}{rgb}{0,0,0}
\definecolor{not-covered}{rgb}{1,0,0}

% \oddsidemargin=-7mm
% \topmargin=-10pt
% \headheight=6pt
% \headsep=10pt
% \textheight=24cm
% \textwidth=17.4cm

\oddsidemargin=0pt
\topmargin=-14mm
\headheight=6pt
\headsep=10pt
\textheight=17cm
\textwidth=25cm

\begin{document}

\begin{vdm_al}
class Á”ïÒ
--$Id: consumer.vpp,v 1.2 2005/10/31 06:48:10 vdmtools Exp $
instance variables
b : Buffer;
producer : ¶YÒ;

operations
public Á”ïÒ : Buffer ==> Á”ïÒ
Á”ïÒ(aBuffer) ==
	(
	b := aBuffer;
	return self
	);
	
€–ÚÁ”ï : seq of char ==> ()
€–ÚÁ”ï(c) == 
	let - = new IO().echo("ThreadID=" ^ Integer`asString(threadid) ^ ", ConsumeData=" ^ c ^ ",\n")
	in
	skip;
	
public doit : () ==> ()
doit() ==
	while true do (
		let c = b.Get()
		in
		/* ‚±‚Ìif•¶‚ª‚È‚¢‚Ædeadlock”­¶*/
		if c = 'Z' then
			return
		else
		/* */
			€–ÚÁ”ï([c]);
	);

public wait : () ==> ()
wait() == skip;
	
sync
	--mutex(€–ÚÁ”ï);
	per wait => #fin(doit) > #act(wait);
	
thread
	doit(); 

end Á”ïÒ
\end{vdm_al}

\begin{rtinfo}
[TotalxCoverage]{vdm.tc}[Á”ïÒ]
\end{rtinfo}

\end{document}

