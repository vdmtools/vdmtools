\begin{vdm_al}
class Á”ïÒ
--$Id: consumer.vpp,v 1.3 2005/11/10 07:15:56 vdmtools Exp $
instance variables
b : Buffer;
producer : ¶YÒ;

operations
public Á”ïÒ : Buffer ==> Á”ïÒ
Á”ïÒ(aBuffer) ==
	(
	b := aBuffer;
	return self
	);
	
€–ÚÁ”ï : seq of char ==> ()
€–ÚÁ”ï(c) == 
	let - = new IO().echo("ThreadID=" ^ Integer`asString(threadid) ^ ", ConsumeData=" ^ c ^ ",\n")
	in
	skip;
	
public doit : () ==> ()
doit() ==
	while true do (
		let c = b.Get()
		in
		/* ‚±‚Ìif•¶‚ª‚È‚¢‚Ædeadlock”­¶*/
		if c = 'Z' then
			return
		else
		/* */
			€–ÚÁ”ï([c]);
	);

public wait : () ==> ()
wait() == skip;
	
sync
	--mutex(€–ÚÁ”ï);
	per wait => #fin(doit) > #act(wait);
	
thread
	doit(); 

end Á”ïÒ

\end{vdm_al}

\begin{rtinfo}
[TotalxCoverage]{vdm.tc}[Á”ïÒ]
\end{rtinfo}
