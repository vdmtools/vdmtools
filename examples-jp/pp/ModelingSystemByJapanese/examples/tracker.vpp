--$Header: /home/vdmtools/cvsroot/toolbox/examples-jp/pp/ModelingSystemByJapanese/examples/tracker.vpp,v 1.1 2006/01/04 06:44:17 vdmtools Exp $
--‘æ‚WÍiÊ‘œj‚ÌŒ´q—Í’ÇÕ‹@‚Ì—á‚ğVDM++‰»‚µ‚½‚à‚Ì
--@–|–óF²Œ´L
class Œ´q—Í’ÇÕ‹@

types

’ÇÕ‹@Œ^ ::
	ƒRƒ“ƒeƒiÊ‘œ	: ƒRƒ“ƒeƒiî•ñŒ^
	H’öÊ‘œ		: H’öî•ñŒ^
inv mk_’ÇÕ‹@Œ^(ƒRƒ“ƒeƒiÊ‘œ,H’öÊ‘œ) ==
	–µ‚‚ª‚È‚¢H(ƒRƒ“ƒeƒiÊ‘œ,H’öÊ‘œ) and
	H’ö‚ª‹æ•Ê‚³‚ê‚Ä‚¢‚éH(H’öÊ‘œ) and
	Ş—¿‚ªˆÀ‘SH(ƒRƒ“ƒeƒiÊ‘œ,H’öÊ‘œ);

ƒRƒ“ƒeƒiî•ñŒ^ = map ƒRƒ“ƒeƒiIDŒ^ to ƒRƒ“ƒeƒiŒ^;
H’öî•ñŒ^ = map H’öIDŒ^ to H’öŒ^;

ƒRƒ“ƒeƒiŒ^ ::
	Šj•ª—ô—Ê	:  real
	Ş—¿		: Ş—¿Œ^;

H’öŒ^ :: 
	“à—e•¨W‡		: set of ƒRƒ“ƒeƒiIDŒ^
	Šú‘Ò‚·‚éŞ—¿	: set of Ş—¿Œ^
	—e—Ê			: nat
inv H’ö == 
	card H’ö.“à—e•¨W‡ <= H’ö.—e—Ê and
	H’ö.Šú‘Ò‚·‚éŞ—¿ <> {};

ƒRƒ“ƒeƒiIDŒ^ = token;
H’öIDŒ^ = token;
Ş—¿Œ^ = token

functions

-- V‚µ‚¢ƒRƒ“ƒeƒi‚ğHê‚É‚¿‚ŞiÊ‘œ˜aj
‚¿‚Ş : ’ÇÕ‹@Œ^ * ƒRƒ“ƒeƒiIDŒ^ * real * Ş—¿Œ^ -> ’ÇÕ‹@Œ^
‚¿‚Ş(‚ ‚é’ÇÕ‹@, ‚ ‚éƒRƒ“ƒeƒiID, ‚ ‚é—Ê, ‚ ‚éŞ—¿) ==
     mk_’ÇÕ‹@Œ^(‚ ‚é’ÇÕ‹@.ƒRƒ“ƒeƒiÊ‘œ munion
                {‚ ‚éƒRƒ“ƒeƒiID |-> mk_ƒRƒ“ƒeƒiŒ^(‚ ‚é—Ê, ‚ ‚éŞ—¿)},
                ‚ ‚é’ÇÕ‹@.H’öÊ‘œ)
pre ‚ ‚éƒRƒ“ƒeƒiID not in set dom ‚ ‚é’ÇÕ‹@.ƒRƒ“ƒeƒiÊ‘œ;

-- ˆÚ“®‚Ì‹–‰Â (’Pƒ‚È˜_—Œ^ŠÖ”)
‹–‰ÂH: ’ÇÕ‹@Œ^ * ƒRƒ“ƒeƒiIDŒ^ * H’öIDŒ^  ->  bool
‹–‰ÂH(mk_’ÇÕ‹@Œ^(‚ ‚éƒRƒ“ƒeƒiÊ‘œ, ‚ ‚éH’öÊ‘œ), ‚ ‚éƒRƒ“ƒeƒiID, ‚ ‚éˆÚ“®æ) ==
    ‚ ‚éƒRƒ“ƒeƒiID in set dom ‚ ‚éƒRƒ“ƒeƒiÊ‘œ and
    ‚ ‚éˆÚ“®æ in set dom ‚ ‚éH’öÊ‘œ and
    card ‚ ‚éH’öÊ‘œ(‚ ‚éˆÚ“®æ).“à—e•¨W‡ < ‚ ‚éH’öÊ‘œ(‚ ‚éˆÚ“®æ).—e—Ê and
    ‚ ‚éƒRƒ“ƒeƒiÊ‘œ(‚ ‚éƒRƒ“ƒeƒiID).Ş—¿ in set ‚ ‚éH’öÊ‘œ(‚ ‚éˆÚ“®æ).Šú‘Ò‚·‚éŞ—¿;

-- H’ö‚Ì“à—e•¨W‡‚©‚çƒRƒ“ƒeƒi‚ğíœ‚·‚é
œ‹‚·‚é: ’ÇÕ‹@Œ^ * ƒRƒ“ƒeƒiIDŒ^ * H’öIDŒ^ -> ’ÇÕ‹@Œ^
œ‹‚·‚é(mk_’ÇÕ‹@Œ^(‚ ‚éƒRƒ“ƒeƒiÊ‘œ, ‚ ‚éH’öÊ‘œ), ‚ ‚éƒRƒ“ƒeƒiID, ‚ ‚éíœŒ³) ==
  let ‚ ‚éH’ö = mk_H’öŒ^(‚ ‚éH’öÊ‘œ(‚ ‚éíœŒ³).“à—e•¨W‡ \ {‚ ‚éƒRƒ“ƒeƒiID},
                     ‚ ‚éH’öÊ‘œ(‚ ‚éíœŒ³).Šú‘Ò‚·‚éŞ—¿,
                     ‚ ‚éH’öÊ‘œ(‚ ‚éíœŒ³).—e—Ê)
  in
    mk_’ÇÕ‹@Œ^(‚ ‚éƒRƒ“ƒeƒiÊ‘œ, ‚ ‚éH’öÊ‘œ ++ {‚ ‚éíœŒ³ |-> ‚ ‚éH’ö})
pre ‚ ‚éíœŒ³ in set dom ‚ ‚éH’öÊ‘œ and
    ‚ ‚éƒRƒ“ƒeƒiID in set ‚ ‚éH’öÊ‘œ(‚ ‚éíœŒ³).“à—e•¨W‡;

-- ‚Q‚Â‚ÌH’öŠÔ‚Åw’è‚³‚ê‚½ƒRƒ“ƒeƒi‚ğˆÚ“®‚·‚é
ˆÚ“®‚·‚é: ’ÇÕ‹@Œ^ * ƒRƒ“ƒeƒiIDŒ^ * H’öIDŒ^ * H’öIDŒ^ -> ’ÇÕ‹@Œ^
ˆÚ“®‚·‚é(‚ ‚é’ÇÕ‹@, ‚ ‚éƒRƒ“ƒeƒiID, ‚ ‚éˆÚ“®æH’öID, ‚ ‚éˆÚ“®Œ³H’öID) ==
   let ‚ ‚éH’ö = mk_H’öŒ^(‚ ‚é’ÇÕ‹@.H’öÊ‘œ(‚ ‚éˆÚ“®æH’öID).“à—e•¨W‡ union {‚ ‚éƒRƒ“ƒeƒiID},
                      ‚ ‚é’ÇÕ‹@.H’öÊ‘œ(‚ ‚éˆÚ“®æH’öID).Šú‘Ò‚·‚éŞ—¿,
                      ‚ ‚é’ÇÕ‹@.H’öÊ‘œ(‚ ‚éˆÚ“®æH’öID).—e—Ê)
   in
     mk_’ÇÕ‹@Œ^(‚ ‚é’ÇÕ‹@.ƒRƒ“ƒeƒiÊ‘œ,
                œ‹‚·‚é(‚ ‚é’ÇÕ‹@,‚ ‚éƒRƒ“ƒeƒiID,‚ ‚éˆÚ“®Œ³H’öID).H’öÊ‘œ ++ 
                	{‚ ‚éˆÚ“®æH’öID |-> ‚ ‚éH’ö})
pre	‹–‰ÂH(‚ ‚é’ÇÕ‹@, ‚ ‚éƒRƒ“ƒeƒiID, ‚ ‚éˆÚ“®æH’öID) and 
	pre_œ‹‚·‚é(‚ ‚é’ÇÕ‹@,‚ ‚éƒRƒ“ƒeƒiID,‚ ‚éˆÚ“®Œ³H’öID);

-- Hê‚©‚çƒRƒ“ƒeƒi‚ğíœ‚·‚é
íœ‚·‚é: ’ÇÕ‹@Œ^ * ƒRƒ“ƒeƒiIDŒ^ * H’öIDŒ^  ->  ’ÇÕ‹@Œ^
íœ‚·‚é(‚ ‚é’ÇÕ‹@, ‚ ‚éƒRƒ“ƒeƒiID, ‚ ‚éíœŒ³) ==
   mk_’ÇÕ‹@Œ^({‚ ‚éƒRƒ“ƒeƒiID} <-: ‚ ‚é’ÇÕ‹@.ƒRƒ“ƒeƒiÊ‘œ,
              œ‹‚·‚é(‚ ‚é’ÇÕ‹@, ‚ ‚éƒRƒ“ƒeƒiID, ‚ ‚éíœŒ³).H’öÊ‘œ)
pre pre_œ‹‚·‚é(‚ ‚é’ÇÕ‹@,‚ ‚éƒRƒ“ƒeƒiID,‚ ‚éíœŒ³);

-- ’ÇÕ‹@Œ^‚Ì•s•ÏğŒ‚Ì‚½‚ß‚É’è‹`‚·‚é•â•ŠÖ”W‡
–µ‚‚ª‚È‚¢H: ƒRƒ“ƒeƒiî•ñŒ^ * H’öî•ñŒ^ -> bool
–µ‚‚ª‚È‚¢H(‚ ‚éƒRƒ“ƒeƒiÊ‘œ, ‚ ‚éH’öÊ‘œ) ==
     forall H’ö in set rng ‚ ‚éH’öÊ‘œ &
        H’ö.“à—e•¨W‡ subset dom ‚ ‚éƒRƒ“ƒeƒiÊ‘œ;

H’ö‚ª‹æ•Ê‚³‚ê‚Ä‚¢‚éH: H’öî•ñŒ^ -> bool
H’ö‚ª‹æ•Ê‚³‚ê‚Ä‚¢‚éH(‚ ‚éH’öÊ‘œ) ==
     not exists ‚ ‚éH’ö1, ‚ ‚éH’ö2 in set dom ‚ ‚éH’öÊ‘œ &
        ‚ ‚éH’ö1 <> ‚ ‚éH’ö2 and
        ‚ ‚éH’öÊ‘œ(‚ ‚éH’ö1).“à—e•¨W‡ inter ‚ ‚éH’öÊ‘œ(‚ ‚éH’ö2).“à—e•¨W‡ <> {};

Ş—¿‚ªˆÀ‘SH: ƒRƒ“ƒeƒiî•ñŒ^ * H’öî•ñŒ^ -> bool
Ş—¿‚ªˆÀ‘SH(‚ ‚éƒRƒ“ƒeƒiÊ‘œ, ‚ ‚éH’öÊ‘œ) ==
     forall H’ö in set rng ‚ ‚éH’öÊ‘œ &
        forall ƒRƒ“ƒeƒiID in set H’ö.“à—e•¨W‡ &
	   ƒRƒ“ƒeƒiID in set dom ‚ ‚éƒRƒ“ƒeƒiÊ‘œ and
           ‚ ‚éƒRƒ“ƒeƒiÊ‘œ(ƒRƒ“ƒeƒiID).Ş—¿ in set H’ö.Šú‘Ò‚·‚éŞ—¿
		   
end Œ´q—Í’ÇÕ‹@
